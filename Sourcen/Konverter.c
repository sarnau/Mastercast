#include "mc_db.h"#include <string.h>#include "dBASE Import.h"/*** *	Vereinfachte Routine zur Wandlung einer Dezimalzahl in eine BinŠrzahl ***/static long		Str2Num(StringPtr theString);static long		Str2Num(StringPtr theString){long		theNum = 0L;	for(;*theString;theString++) {		if(*theString == ' ') continue;		theNum *= 10;		theNum += *theString - '0';	}	return theNum;}/*** *	STR# 3000 IDs ***/enum {	ffName_In_der_Agentur = 1, ffModel_ID, ffNachname, ffVorname, ffAgentur_ID, ffGeschlecht,		ffGeboren_am, ffBase, ffAugenfarbe, ffHaarfarbe, ffHaare, ffGroesse, ffBrust, ffBH_Groesse,		ffTaille, ffHuefte, ffSchuhe, ffHut, ffRing, ffKonfektionsgroesse, ffKragengroesse, ffLook,		ffBesonderheiten, ffGeeignet_fuer, ffTalente, ffSportarten, ffSprachen, ffFuehrerscheine,		ffHaartyp, ffPhotograf_Photo_1, ffVertragsAgentur, ffAgentur2, ffAgentur3, ffAgentur4,		ffAgentur5, ffAgentur6, ffBildNr1, ffANZAL_BILDER, ffSTATUS_DATE_OK, ffFSize };/*** *	Datensatz in die DB einfŸgen ***/Ptr			EnterDatensatz(dBASEFile *db, long id);Ptr			EnterDatensatz(dBASEFile *db, long id){ModellStruct	*ms;UnsPtr			s;	ms = (ModellStruct*)NewPtrClear(sizeof(ModellStruct));	ThrowIfMemFail_(ms);	ms->Id = Str2Num(db->GetInd(id, 3000, ffModel_ID));			// ID in der Modellagentur	ms->Agentur = Str2Num(db->GetInd(id, 3000, ffAgentur_ID));	// ID der Modellagentur	strncpy(ms->Modellname, (Ptr)db->GetInd(id, 3000, ffName_In_der_Agentur), sizeof(ms->Modellname)-1);	// Name des Modells in der Agentur	if(strlen(ms->Modellname) > (sizeof(ms->Modellname) - 1))		DebugStr("\pModellname hat †berlŠnge!");//	strncpy(ms->Vorname, (Ptr)db->GetInd(id, 3000, ffVorname), sizeof(ms->Vorname)-1);//	strncpy(ms->Nachname, (Ptr)db->GetInd(id, 3000, ffNachname), sizeof(ms->Nachname)-1);	ms->Geschlecht = db->GetIndex(id, 3000, ffGeschlecht, 2012);	ms->Base = db->GetIndex(id, 3000, ffBase, 2011);	s = db->GetInd(id, 3000, ffGeboren_am);	if(*s) {		s[4] = 0;		ms->GebJahr = Str2Num(s);		if(ms->GebJahr < 100)			ms->GebJahr += 1900;	}	ms->Groesse = Str2Num(db->GetInd(id, 3000, ffGroesse));	ms->Brust = Str2Num(db->GetInd(id, 3000, ffBrust));	ms->Taille = Str2Num(db->GetInd(id, 3000, ffTaille));	ms->Huefte = Str2Num(db->GetInd(id, 3000, ffHuefte));	ms->Konfektion = Str2Num(db->GetInd(id, 3000, ffKonfektionsgroesse));	ms->Kragen = Str2Num(db->GetInd(id, 3000, ffKragengroesse));//	strncpy((char*)&ms->Bh, (Ptr)db->GetInd(id, 3000, ffBH_Groesse), sizeof(ms->Bh));	ms->Schuhe = Str2Num(db->GetInd(id, 3000, ffSchuhe));	ms->Hut = Str2Num(db->GetInd(id, 3000, ffHut));	ms->Ring = Str2Num(db->GetInd(id, 3000, ffRing));	ms->Haarfarbe = db->GetIndex(id, 3000, ffHaarfarbe, 2000);	ms->Haartyp = db->GetIndex(id, 3000, ffHaartyp, 2001);	ms->Haare = db->GetIndex(id, 3000, ffHaare, 2002);	ms->Augenfarbe = db->GetIndex(id, 3000, ffAugenfarbe, 2003);	ms->Look = db->GetBitindex(id, 3000, ffLook, 2004);	ms->Eignung = db->GetBitindex(id, 3000, ffGeeignet_fuer, 2005);	ms->Talente = db->GetBitindex(id, 3000, ffTalente, 2006);	ms->Fuehrerschein = db->GetBitindex(id, 3000, ffFuehrerscheine, 2007);	ms->Sportarten = db->GetBitindex(id, 3000, ffSportarten, 2008);	ms->Besonders = db->GetBitindex(id, 3000, ffBesonderheiten, 2009);	ms->Sprachen = db->GetBitindex(id, 3000, ffSprachen, 2010);	ms->PicAnz = Str2Num(db->GetInd(id, 3000, ffANZAL_BILDER));	DB_MInsert(ms);	return (Ptr)ms;}/*** *	STR# 3001 IDs ***/enum {	afName = 1, afStrasse, afLand, afPLZ, afOrt, afTelefon, afTelefax, afID, afFSize };/*** *	Datensatz in die Agentur-DB einfŸgen ***/Ptr			AgenturList::EnterAgenturDatensatz(dBASEFile *db, long id){Agentur			*as = new Agentur;	as->Id = Str2Num(db->GetInd(id, 3001, afID));			// ID in der Modellagentur	strcpy(as->Name, (Ptr)db->GetInd(id, 3001, afName));	// Name der Agentur	strcpy(as->Strasse, (Ptr)db->GetInd(id, 3001, afStrasse));	strcpy(as->Ort, (Ptr)db->GetInd(id, 3001, afLand));	strcat(as->Ort, "-");	strcat(as->Ort, (Ptr)db->GetInd(id, 3001, afPLZ));	strcat(as->Ort, " ");	strcat(as->Ort, (Ptr)db->GetInd(id, 3001, afOrt));	strcpy(as->Telefon, (Ptr)db->GetInd(id, 3001, afTelefon));	strcpy(as->Fax, (Ptr)db->GetInd(id, 3001, afTelefax));	if(AList)		AList->Add(as);	return (Ptr)as;}